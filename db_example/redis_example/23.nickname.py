# -*- coding: utf-8 -*-
"""
__author__ = 'do'
__mtime__ = '2017/12/4'
__content__ = ''
"""

import redis
from redis.sentinel import Sentinel
import time

host = [["127.0.0.1",7379],["127.0.0.1",7380]]
password = 'pwd'
sentinel = Sentinel(host)

print sentinel.discover_master('mymaster')

r = sentinel.master_for('mymaster',password=password)

all_userid = ['895185', '2641093', '2406725', '1076206', '1183233', '5553314', '1428172', '624953', '5552244', '6438616', '1387090', '3572136', '258256', '6430542', '6421055', '6366053', '5535272', '850606', '6430549', '6926381', '6376166', '6455005', '2335559', '4189558', '3935553', '6077156', '2579033', '5068024', '5535271', '6430981', '5551361', '980913', '1974380', '6395268', '2951014', '6418222', '2003793', '1424122', '5516318', '2620565', '6429594', '6504448', '6404855', '6428182', '6429691', '621111', '2380951', '5485517', '5911364', '324060', '3141369', '1162071', '3049830', '5530157', '1012747', '917308', '1147315', '5401999', '1915578', '3953960', '3124952', '5542646', '2978306', '820516', '6457789', '6418610', '3587168', '3938500', '3002972', '1300835', '3938977', '5551731', '3229579', '2418965', '6382809', '1698093', '1540669', '5291775', '6422161', '2649318', '6429614', '2933300', '5765437', '5534077', '1236260', '6446771', '5813665', '6419073', '1379730', '3188488', '2224931', '176249', '5553332', '6447431', '5552409', '2310930', '3103576', '4676116', '1589787', '342037', '5449773', '5553048', '2696280', '2027098', '5535502', '2029868', '5535882', '6449138', '6454250', '2812913', '1082342', '6391343', '6399846', '6431144', '3091437', '3770112', '4667554', '6423699', '6060757', '6433454', '6399863', '536037', '1067233', '5547121', '2688602', '3108270', '6430674', '6453416', '3329522', '2752890', '6423747', '6399901', '1654132', '5546118', '5530570', '711873', '6454008', '2952831', '3015163', '5542494', '2026433', '6461260', '6443962', '5135568', '815735', '6424717', '1642207', '3615170', '6433183', '832553', '5017830', '6407841', '6375764', '913345', '2430921', '602013', '1182892', '2752875', '771877', '6454323', '340440', '1983948', '3179653', '439417', '1235766', '1219898', '5522535', '6447557', '1404481', '6429773', '5426151', '3050026', '6414325', '328798', '355657', '6432041', '819710', '6446686', '820754', '5484235', '5001021', '586996', '4417490', '6447838', '2101155', '2141819', '617221', '3080555', '4010538', '812182', '6446593', '6430620', '4560720', '792549', '6448143', '5539765', '1283196', '2014637', '6384067', '2532273', '2765355', '6449022', '2913480', '720639', '5303327', '5544123', '2623899', '3957003', '1589769', '1348343', '1060035', '5552420', '6011888', '2029880', '351853', '6447887', '780128', '6404749', '6438582', '6452401', '1377243', '6382528', '6422285', '337837', '3014449', '2599782', '5403630', '629784', '6446740', '6429860', '6438571', '5545551', '720024', '3409381', '2797366', '2906595', '399575', '914836', '628064', '3081020', '749666', '5545777', '1197874', '5717328', '1453163', '900723', '1348506', '530622', '5227932', '6452696', '5458860', '381851', '410596', '355856', '2345139', '2988803', '6400818', '1104064', '1059224', '3113749', '2954193', '6441322', '2837277', '5552529', '2744458', '4803153', '826517', '6439853', '6347669', '2154089', '340062', '618654', '1541641', '6140593', '2193738', '621087', '2696313', '6454125', '290133', '5543911', '6255539', '362522', '6274965', '355947', '753955', '1088410', '6401270', '5901016', '5535866', '4806168', '554181', '6045584', '6419667', '6437851', '6462344', '6004394', '698733', '5544651', '3818503', '2530166', '1363247', '1301968', '3695470', '2096001', '3354573', '2198229', '3806085', '1377390', '454470', '451058', '3092249', '2649437', '4840524', '4688925', '1509368', '6396531', '226872', '836670', '6414272', '2994535', '1464885', '2247017', '3941588', '3233578', '4785853', '670111', '615101', '450260', '1170909', '6454219', '6446541', '5553361', '6429472', '1009546', '754104', '3754989', '619636', '2517081', '6407685', '607848', '3698258', '3091414', '2410921', '1161021', '1098887', '6381870', '951260', '3050196', '1671667', '3047950', '5552763', '1058557', '3801729', '6445772', '6168378', '6453379', '899298', '2670286', '336452', '3017057', '2059203', '1075862', '6321297', '67969', '2696337', '1253142', '462954', '2024200', '1713643', '6461112', '6428993', '5847553', '6928095', '355024', '5552558', '6431029', '2664636', '3488328', '2708599', '4871125', '976617', '4728788', '6101450', '6461227', '4671438', '6033821', '1387465', '6453399', '251999', '6310854', '6429520', '4689254', '6461015', '6439344', '6296509', '5357341', '6447419', '6427489', '3751289', '2539875', '2525923', '5533987', '5910925', '6446964', '1186980', '4662965', '6276507', '6438595', '969525', '6457161', '841715', '1331118', '1220342', '2323760', '6422168', '5551408', '2934584', '1396523', '1749733', '5545211', '1509230', '6430993', '582713', '5529698', '1466404', '797602', '133308', '6447467', '5542956', '3699531', '2729712', '2098712', '2153984', '2029825', '6460104', '720206', '5519810', '925777', '6429675', '5549965', '3385233', '6461240', '2431258', '5543202', '1050467', '5545273', '5534443', '1501849', '753992', '398924', '3782045', '1152424', '5522168', '921279', '6434250', '653702', '803252', '2551195', '6420366', '3188543', '316384', '620972', '5446260', '337059', '2371392', '1533635', '2851111', '6399940', '337759', '1150045', '1960856', '2639952', '5702993', '3280356', '4801392', '5550861', '5010700', '5549813', '6153362', '5545921', '1797062', '2869639', '3758719', '641922', '3960712', '1174420', '6400870', '2710183', '854047', '6412494', '5860511', '5544939', '342026', '4847104', '3537799', '5539241', '5867811', '5549717', '3048850', '1616995', '1404489', '6426291', '279124', '5492678', '348192', '921975', '6431609', '2524866', '6449261', '6411902', '6430233', '6012400', '3404357', '5481219', '1191039', '5013608', '1908717', '2902954', '6430960', '6208792', '1958170', '1099198', '375715', '6455839', '606338', '6075974', '6430178', '661002', '5459538', '3551568', '406846', '1854458', '2934539', '6448961', '6446550', '6422201', '1057885', '472521', '3014978', '258757', '5458488', '1343393', '2923146', '280249', '2738987', '3125246', '832096', '6454230', '4198328', '787615', '2127244', '1019071', '3382598', '2173370', '2223968', '3061884', '3568738', '5042855', '6446819', '5795250', '826971', '565878', '6447822', '6454993', '1655750', '2526221', '6446925', '1520382', '1383532', '872138', '1420479', '6310817', '6447455', '2891691', '2373098', '2962628', '2211790', '6423540', '1384704', '5522257', '3044200', '2435637', '5550130', '5539758', '634382', '1139121', '983258', '1053925', '989789', '5552354', '1192143', '1840780', '895784', '1278740', '6418157', '3017091', '6422096', '6401876', '1712963', '5545542', '5545487', '6422090', '5449604', '5485362', '2144160', '5291150', '6430566', '5001247', '6415363', '5549664', '827813', '6432345', '619384', '400453', '6428161', '3904274', '1501858', '2027648', '870606', '6446584', '5982093', '6446999', '623756', '5983666', '4099060', '6395513', '1114051', '6460916', '3320870', '2545211', '3048893', '1187099', '2587606', '164270', '1559108', '1005836', '6455566', '6245112', '2898212', '5552537', '6447980', '1507509', '6447992', '2224887', '2065431', '1657843', '5522145', '6389515', '4722497', '6420963', '2658414', '5779149', '1953562', '1867484', '5117246', '2549902', '6429748', '5221997', '1949094', '4715266', '1657308', '6456426', '6344625', '6431132', '5482264', '327842', '5504011', '1511542', '6422145', '1747247', '5428361', '6438686', '6423546', '5287750', '623056', '400391', '3485524', '6422065', '3567322', '1954048', '143147', '3281695', '2566402', '4900461', '5538965', '6428604', '4699078', '5544709', '600310', '5544831', '5402209', '5547318', '6757676', '6404336', '6005000', '6422633', '5553412', '5553147', '3382415', '6454375', '2328350', '6386036', '6427889', '5793928', '2047213', '5428521', '3725654', '1072583', '450452', '5545993', '100296', '5485883', '6646369', '2920800', '5545744', '174287', '1180268', '6432123', '604425', '2494080', '227604', '2485747', '5547030', '5522357', '6400161', '6447911', '6406846', '6461284', '6441287', '6392300', '5538987', '3136265', '5546133', '6446644', '6419340', '6423955', '1385510', '631753', '5535995', '1911994', '1078303', '5522054', '3168697', '342122', '6457372', '5062493', '5111554', '5992916', '6418111', '1323466', '1610138', '1616387', '622444', '6407573', '940875', '6416744', '729833', '1891852', '3862722', '3872474', '5522457', '2027512', '6419617', '2833559', '1823754', '5546630', '6401897', '6449514', '336660', '732683', '6453577', '2002277', '601999', '4318896', '1030142', '1258002', '6914136', '6453476', '6431116', '6018801', '4520672', '6405438', '866180', '6460897', '1122746', '3860006', '5535696', '6430937', '5542889', '2026177', '6453971', '833595', '1442716', '5534753', '405638', '2312521', '6426184', '605476', '3002357', '5052613', '747064', '5559442', '2491722', '1231060', '456820', '796618', '1096397', '6418092', '1998368', '6439931', '1472360', '5505793', '708821', '6247093', '2618360', '5544324', '5552218', '2388507', '3337066', '623766', '2393926', '2097317', '943872', '5549156', '1577257', '5403684', '6670214', '6422108', '1232062', '369838', '5535939', '581840', '6457459', '1016522', '1383591', '6408708', '3952065', '5505745', '3043725', '6427466', '2917676', '3915557', '5529773', '632986', '3540299', '322191', '322190', '1533619', '2399855', '2224980', '2660060', '1103295', '417810', '2524736', '4847053', '2681263', '648855', '1541336', '5547195', '1603140', '1627978', '115435', '1088433', '2613396', '2691487', '6453437', '6441095', '2159751', '1353017', '2758634', '6399578', '4214146', '1630179', '6421295', '920285', '768816', '1743364', '6422030', '660206', '794769', '5896097', '2380624', '2499846', '2924226', '5540187', '762454', '6453638', '5546856', '1830231', '410507', '227496', '6363916', '307671', '2356666', '6363035', '2009704', '5547455', '5539002', '5522637', '5546404', '6402115', '6385733', '3952939', '6090558', '5550425', '508008', '3150918', '6401184', '3154697', '6061284', '1068587', '790342', '4047244', '6413973', '199237', '5550511', '2587764', '6376933', '604627', '4873575', '5595680', '2975698', '6381450', '1554438', '1628406', '6430204', '2553505', '2556024', '3097057', '612669', '4745026', '2715980', '450489', '623759', '2952889', '4899797', '2849544', '2963337', '6453546', '5504537', '742725', '5040185', '6431005', '6385783', '5551353', '5544504', '2719721', '282896', '1861735', '6430520', '5533683', '2589011', '5552789', '6447442', '802609', '2359929', '2393355', '6095628', '2654432', '2229545', '5836167', '2268921', '1311524', '4523198', '4075623', '4667120', '4318759', '2258694', '1387860', '6423794', '5550458', '5209253', '5486369', '345781', '1799617', '343698', '6446998', '3162000', '2526817', '6418128', '6295113', '143276', '1269551', '5546174', '619419', '5486430', '5545368', '6423846', '5540112', '6430965', '4811486', '3016358', '6454047', '5519902', '3453739', '2614319', '5552257', '348199', '6432903', '1399819', '5515616', '6447655', '3614049', '627824', '6421188', '1559672', '331826', '4748594', '1575347', '1689706', '3165337', '3081120', '5546099', '1658486', '6411485', '2964163', '6430970', '3125401', '2676455', '4391873', '3225290', '4848471', '347820', '1146685', '1387992', '5708613', '2738689', '6418235', '2477888', '3499396', '6395278', '2737410', '5486050', '5542692', '904742', '5544219', '3083433', '1816719', '5053178', '714611', '3049538', '5547480', '6401234', '5534500', '2961704', '5538986', '3504117', '895120', '39508', '6461613', '857531', '2937329', '1322342', '1645066', '1546667', '1583604', '400225', '5519970', '6362356', '6422079', '368238', '3774066', '6427416', '31841', '5522694', '6427554', '3578141', '1488082', '5544771', '3908442', '423409', '5536010', '1262730', '2713623', '3180021', '2145510', '6430309', '2113664', '6397414', '211954', '6447543', '3762538', '6372607', '821420', '6395495', '6453516', '5545297', '5544696', '4780513', '6446522', '6424079', '6156748', '454285', '6428183', '6399816', '2845749', '6436557', '673545', '2535017', '2845748', '572538', '5535940', '6453810', '6395687', '6088654', '403060', '2917652', '1190153', '2731284', '4846297', '6361035', '2470203', '1164832', '5173233', '618731', '1192801', '1980018', '6381953', '6431040', '2710216', '937974', '829296', '6005105', '6357496', '6181292', '610951', '6447713', '876025', '2867772', '1786895', '3007047', '960453', '2112399', '331639', '6334822', '6376307', '3137856', '1231776', '6391471', '2768934', '3162100', '6181562', '5529881', '1648568', '654071', '6423897', '2004397', '6665746', '6362988', '754158', '1628388', '1007736', '1322385', '6391804', '6430719', '2354933', '2174912', '6012642', '6446619', '6422184', '2660541', '1376934', '654154', '6453562', '4967870', '5836055', '2569690', '6461388', '1695785', '5544205', '3129201', '6415086', '2132408', '6383355', '1630820', '5543550', '6414537', '5539776', '2484241', '1692552', '3165826', '2457116', '6384053', '3044537', '6455032', '2435488', '5552840', '1125313', '1226181', '6447035', '6418176', '530100', '2438086', '2444054', '5543935', '6395533', '315662', '6418666', '5552174', '1508566', '2736195', '3050147', '6429878', '527391', '6422208', '4393872', '6434378', '6422134', '353643', '502659', '3228619', '1200368', '1875690', '6398764', '4306008', '1695228', '6454137', '5542634', '1807643', '1015696', '3911553', '6429781', '1134371', '1384793', '2183151', '967202', '2184597', '6406670', '4569745', '855794', '6446510', '4364609', '6245328', '250100', '6446633', '1704245', '621770', '6430947', '1813268', '3444253', '878305', '2264707', '3363558', '2411979', '4885795', '1584978', '1139230', '5542558', '1280552', '398765', '2131438', '2516227', '2462718', '5937473', '1539735', '288630', '2952735', '992242', '997909', '5535816', '2245912', '5794449', '2940435', '5870488', '6423877', '3050172', '6422050', '1612808', '1884491', '5291106', '3176135', '3044058', '5544647', '5545223', '727663', '5839781', '2277839', '1481160', '1577857', '621809', '5390132', '176243', '836640', '6423685', '2401445', '5007060', '4244881', '1589355', '6382601', '5390033', '2333485', '6367915', '2952708', '5856869', '1127825', '3001636', '5488985', '1001720', '321874', '1737063', '1668560', '5539831', '3405394', '3149683', '2363889', '5024769', '1720299', '6454353', '6429950', '6447044', '3175798', '1868290', '1078509', '2417153', '5532640', '166859', '5550583', '3153162', '6453743', '6390199', '2982195', '6423560', '5546495', '2963176', '1288174', '1338760', '2739421', '3047762', '5535788', '1078321', '5550446', '3795422', '3015125', '6427123', '3083537', '2380484', '6423568', '1077554', '2039885', '5926710', '2171665', '3884857', '1503182', '1351850', '2276421', '2681339', '1275710', '2827291', '5457698', '810587', '6454878', '6399882', '5551904', '5042465', '4109230', '5551868', '4614183', '6439109', '5402429', '6383945', '1325504', '6348206', '2627944', '619548']

print len(all_userid),all_userid

p = r.pipeline(transaction=False)
for userid in all_userid:
    nickname = 'Bsfb%s'%userid
    key = 'hu:%s'%userid
    p.hmset(key,{'nickname':nickname})

p.execute()